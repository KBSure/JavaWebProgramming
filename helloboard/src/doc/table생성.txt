-- TABLE 생성 스크립트입니다!

-- user Table Create SQL
CREATE TABLE user
(
    `useridx`   INT            NOT NULL    AUTO_INCREMENT COMMENT '사용자 인덱스', 
    `secNum`    VARCHAR(14)    NOT NULL    COMMENT '주민등록번호', 
    `pw`        VARCHAR(20)    NOT NULL    COMMENT '비밀번호', 
    `id`        VARCHAR(20)    NOT NULL    COMMENT '아이디', 
    `joinDate`  DATE           NOT NULL    COMMENT '가입날짜', 
    `joinTime`  TIME           NOT NULL    COMMENT '가입시간', 
    `grade`     VARCHAR(20)    NOT NULL    COMMENT '사용자등급', 
    PRIMARY KEY (useridx)
);

ALTER TABLE user COMMENT '사용자';


-- board Table Create SQL
CREATE TABLE board
(
    `boardidx`  INT            NOT NULL    AUTO_INCREMENT COMMENT '게시글 인덱스', 
    `title`     VARCHAR(45)    NOT NULL    COMMENT '제목', 
    `content`   TEXT           NULL        COMMENT '내용', 
    `fileName`  VARCHAR(45)    NULL        COMMENT '첨부파일', 
    `writer`    INT            NOT NULL    COMMENT '작성자', 
    `date`      DATE           NOT NULL    COMMENT '작성일', 
    `time`      TIME           NOT NULL    COMMENT '작성시간', 
    `category`  VARCHAR(20)    NOT NULL    COMMENT '카테고리', 
    `topic`     VARCHAR(20)    NOT NULL    COMMENT '하위카테고리', 
    `view`      INT            NOT NULL    COMMENT '게시글 조회수', 
    `great`     INT            NOT NULL    COMMENT '추천수', 
    PRIMARY KEY (boardidx)
);

ALTER TABLE board COMMENT '게시글';

ALTER TABLE board ADD CONSTRAINT FK_board_writer_user_useridx FOREIGN KEY (writer)
 REFERENCES user (useridx)  ON DELETE RESTRICT ON UPDATE RESTRICT;


-- tag Table Create SQL
CREATE TABLE tag
(
    `tagidx`    INT            NOT NULL    AUTO_INCREMENT COMMENT '태그 인덱스', 
    `tagName`   VARCHAR(45)    NULL        COMMENT '태그 이름', 
    `refCount`  INT            NULL        COMMENT '참조 수', 
    PRIMARY KEY (tagidx)
);

ALTER TABLE tag COMMENT '태그';


-- reply Table Create SQL
CREATE TABLE reply
(
    `replyidx`   INT     NOT NULL    AUTO_INCREMENT COMMENT '댓글 인덱스', 
    `useridx`    INT     NOT NULL    COMMENT '작성자', 
    `reply`      TEXT    NOT NULL    COMMENT '댓글 내용', 
    `boardidx`   INT     NOT NULL    COMMENT '게시글 인덱스', 
    `replyDate`  DATE    NOT NULL    COMMENT '작성일', 
    `replyTime`  TIME    NOT NULL    COMMENT '작성시간', 
    PRIMARY KEY (replyidx)
);

ALTER TABLE reply COMMENT '댓글';

ALTER TABLE reply ADD CONSTRAINT FK_reply_useridx_user_useridx FOREIGN KEY (useridx)
 REFERENCES user (useridx)  ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE reply ADD CONSTRAINT FK_reply_boardidx_board_boardidx FOREIGN KEY (boardidx)
 REFERENCES board (boardidx)  ON DELETE RESTRICT ON UPDATE RESTRICT;


-- boardtag Table Create SQL
CREATE TABLE boardtag
(
    `boardidx`  INT    NOT NULL    COMMENT '게시글 인덱스', 
    `tagidx`    INT    NOT NULL    COMMENT '태그 인덱스', 
    `btidx`     INT    NOT NULL    AUTO_INCREMENT COMMENT '보드태그 인덱스', 
    PRIMARY KEY (btidx)
);

ALTER TABLE boardtag ADD CONSTRAINT FK_boardtag_boardidx_board_boardidx FOREIGN KEY (boardidx)
 REFERENCES board (boardidx)  ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE boardtag ADD CONSTRAINT FK_boardtag_tagidx_tag_tagidx FOREIGN KEY (tagidx)
 REFERENCES tag (tagidx)  ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE `helloboard`.`user`
ADD COLUMN `name` VARCHAR(30) NOT NULL AFTER `grade`;

